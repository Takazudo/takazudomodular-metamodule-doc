---
title: シミュレーターのビルド
---

### シミュレーターのビルド

シミュレーターは SDL2 を使用しており、ホストマシンにインストールされている必要があります。グラフィックスとオーディオ出力をシミュレートします。
[セットアップ](./setup.md)に記載されている要件をインストールしてください。

正しいブランチにいること、そしてサブモジュールをすでに更新していることを確認してください。

simulator ディレクトリに移動します:

```
cd simulator
```

ビルドシステムを生成します:

```
cmake --fresh -B build -GNinja      # または任意のビルドシステム
```

ビルドします:

```
cmake --build build
```

実行します:

```
build/simulator

# 使用可能なコマンドライン引数を確認するには:
build/simulator --help
```

引数の詳細については [シミュレーターの使用ガイド](simulator-usage.md) を参照してください。

ショートカットとして、上記の cmake コマンドをラップする Makefile があります。
以下のように実行できます:

```
# ビルドシステムを生成し（必要な場合）、ビルド:
make

# シミュレーターを実行:
make run

# クリーン:
make clean
```

`make run` では引数を渡すことができないことに注意してください。

## assets ディレクトリへの PNG 画像の追加/削除

`firmware/assets` ディレクトリで画像を追加/削除する場合、シミュレーターが更新された画像アセットを表示する前に、assets tar イメージを再ビルドする必要があります。これは通常通りファームウェアをビルドするたびに自動的に行われますが、`asset-image` cmake ターゲットをビルドすることもできます:

```
# firmware/assets ディレクトリでグラフィカルアセットを編集/追加/削除

cd ../firmware
cmake -B build -GNinja      # または任意のビルドシステム
cmake --build build -- asset-image
cd ../simulator

# これでシミュレーターを実行すると更新されたアセットが使用されます
```

理由は、シミュレーターがホストファイルシステム上の `firmware/assets` ディレクトリに直接アクセスせず、ファームウェアと同じことを行うからです: assets tarball を仮想 FatFS RAM ディスクに展開します。
